#define _CRT_SECURE_NO_WARNINGS

#include<stdio.h>
#include<string.h>
#include<stdlib.h>
#include<time.h>
#include<ctype.h>

void hangmancase1(void) {
	printf("         \n");
	printf("              \n");
	printf("           \n");
	printf("         \n");
	printf("        \n");
	printf("          \n");
	printf("              \n");
	printf("              \n");
	printf("             \n");
	printf("             \n");
	printf("             \n");
	printf("              \n");
	printf("             \n");
	printf("            \n");
	printf("             \n");
	printf("               \n");
	printf("-----           \n");
}
void hangmancase2(void) {
	printf("         \n");
	printf("  |            \n");
	printf("  |         \n");
	printf("  |       \n");
	printf("  |      \n");
	printf("  |        \n");
	printf("  |            \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |          \n");
	printf("  |           \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase3(void) {
	printf("  ------        \n");
	printf("  |            \n");
	printf("  |         \n");
	printf("  |       \n");
	printf("  |      \n");
	printf("  |        \n");
	printf("  |            \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |          \n");
	printf("  |           \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase4(void) {
	printf("  ------        \n");
	printf("  |    |        \n");
	printf("  |         \n");
	printf("  |       \n");
	printf("  |      \n");
	printf("  |        \n");
	printf("  |            \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |          \n");
	printf("  |           \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase5(void) {
	printf("  ------        \n");
	printf("  |    |        \n");
	printf("  |    -        \n");
	printf("  |  /   \\      \n");
	printf("  | |     |     \n");
	printf("  |  \\   /      \n");
	printf("  |    -        \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |           \n");
	printf("  |            \n");
	printf("  |           \n");
	printf("  |          \n");
	printf("  |           \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase6(void) {
	printf("  ------        \n");
	printf("  |    |        \n");
	printf("  |    -        \n");
	printf("  |  /   \\      \n");
	printf("  | |     |     \n");
	printf("  |  \\   /      \n");
	printf("  |    -        \n");
	printf("  |    |        \n");
	printf("  |    |       \n");
	printf("  |    |       \n");
	printf("  |    |       \n");
	printf("  |    |        \n");
	printf("  |           \n");
	printf("  |          \n");
	printf("  |           \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase7(void) {
	printf("  ------        \n");
	printf("  |    |        \n");
	printf("  |    -        \n");
	printf("  |  /   \\      \n");
	printf("  | |     |     \n");
	printf("  |  \\   /      \n");
	printf("  |    -        \n");
	printf("  |    |        \n");
	printf("  |   /|       \n");
	printf("  |  / |       \n");
	printf("  | /  |       \n");
	printf("  |    |        \n");
	printf("  |           \n");
	printf("  |          \n");
	printf("  |           \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase8(void) {
	printf("  ------        \n");
	printf("  |    |        \n");
	printf("  |    -        \n");
	printf("  |  /   \\      \n");
	printf("  | |     |     \n");
	printf("  |  \\   /      \n");
	printf("  |    -        \n");
	printf("  |    |        \n");
	printf("  |   /|\\       \n");
	printf("  |  / | \\      \n");
	printf("  | /  |  \\     \n");
	printf("  |    |        \n");
	printf("  |           \n");
	printf("  |          \n");
	printf("  |           \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase9(void) {
	printf("  ------        \n");
	printf("  |    |        \n");
	printf("  |    -        \n");
	printf("  |  /   \\      \n");
	printf("  | |     |     \n");
	printf("  |  \\   /      \n");
	printf("  |    -        \n");
	printf("  |    |        \n");
	printf("  |   /|\\       \n");
	printf("  |  / | \\      \n");
	printf("  | /  |  \\     \n");
	printf("  |    |        \n");
	printf("  |   /        \n");
	printf("  |  /         \n");
	printf("  | /          \n");
	printf("  |             \n");
	printf("-----           \n");
}
void hangmancase10(void) {
	printf("  ------        \n");
	printf("  |    |        \n");
	printf("  |    -        \n");
	printf("  |  /   \\      \n");
	printf("  | |     |     \n");
	printf("  |  \\   /      \n");
	printf("  |    -        \n");
	printf("  |    |        \n");
	printf("  |   /|\\       \n");
	printf("  |  / | \\      \n");
	printf("  | /  |  \\     \n");
	printf("  |    |        \n");
	printf("  |   / \\       \n");
	printf("  |  /   \\      \n");
	printf("  | /     \\     \n");
	printf("  |             \n");
	printf("-----           \n");
}

int win = 0.0;							//승패카운트
int lose = 0.0;							//승패카운트

int play() {
	printf("제시어는 '과일'입니다\n");

	char sample[39][20] = {
		"apple","grapes","peach","orange","apricat","mango",
		"sapodilla","kiwi","plum","pear","lichy","strawberry",
		"banana","grapefruit","pomegranate","blackberry","raspberry"
		"wattermelon","melon","custardapple","papaya","pineapple",
		"guava","coconut","casabamelon","cherry","turkishpurplefig","jackfruit",
		"dragonfruit","durianfruit","loquats","dates","rambutan",
		"stanleyplum","damsonplum","greenapple","angelenoplum","bingcherry","physalis"
	};									//39개 과일 단어 목록
	srand(time(0));
	int choose = rand() % 39;			//39개 중에 랜덤으로 단어 하나 선택
	char solution[20];					//랜덤으로 선정된 정답 단어 저장할 배열
	strcpy(solution, sample[choose]);	//배열에 단어 저장

	int length = strlen(solution);		//답안의 글자 수
	char answer[20];
	for (int i = 0; i < length; i++) answer[i] = '_';
										//답안 작성 할 배열
										//답안 글자 수 만큼 언더바로 채워줌
										//맞는 글자가 나올 때 마다 수정해서 채워 줄 예정
	answer[length] = '\0';				//끝자리 표시
	printf("단어는 %d자리 입니다\n", length);				//최초 단어 칸수 제시

	char canuse[] = "abcdefghijklmnopqrstuvwxyz";
										//입력할 수 있는 문자들
										//사용한 문자의 경우 언더바로 수정되게끔 할 예정
	int count = 0;						//틀린 횟수를 세기 위한 변수, 10번 틀리면 게임 종료

	char input;

	while (1) {							//게임 시작
		printf("남은 횟수는 %d번 입니다\n", 10 - count);
		printf("다음은 입력 가능한 문자 입니다\n%s\n", canuse);

		while (1) {
			int checkcanuse = 0;
			input = getche();
			for (int i = 0; i < 26; i++) {
				if (canuse[i] == input) {
					checkcanuse++;
					break;
				}
			}							//사용가능한 문자인지 확인하는 과정
			
			if ((checkcanuse != 0) && (input != '_')) {
				char* locate = strchr(canuse, input);
				*locate = '_';
				break;
			}							//문자가 1개로 일치한다고 판단하면
										//사용가능으로 판정, 공란처리, 이후진행
			printf("\n입력할 수 없는 문자입니다 다시 입력해 주세요\n");
										//사용불가 판정시 재입력 받음
		}								//문자 입력받아서 사용할 수 있는 문자인지 검증하는 while문

		int issolution = 0;				//일치하는 글자가 있는지 확인 및 카운트 하기 위한 변수
		for (int j = 0; j < length; j++) {
			if (solution[j] == input) {
				answer[j] = input;		//일치하는 문자가 있으면 그 자리를 글자로 채움
				issolution++;			//일치하는 문자가 있으면 카운트 해서 0의 값을 바꿔줌
			}
		}

		printf("\n현재 상황 : %s\n", answer);			//중간 진행상황 공개

		if (strcmp(solution, answer) == 0)break;
										//단어가 일치하면 게임 종료
										//카운트가 10이 아닌 상태로 종료되기 때문에
										//성공했는지 여부를 판단할 수 있음
		if (issolution != 0) {			//일치하는 문자가 있었을 경우

			//input값이 있었다고 알려주고 다음 입력값을 받도록 while문 초반으로 돌아감
		}
		else {
			count++;					//틀린 횟수 카운트
			
		}
		switch (count) {
		case 1: hangmancase1(); break;
		case 2: hangmancase2(); break;
		case 3: hangmancase3(); break;
		case 4: hangmancase4(); break;
		case 5: hangmancase5(); break;
		case 6: hangmancase6(); break;
		case 7: hangmancase7(); break;
		case 8: hangmancase8(); break;
		case 9: hangmancase9(); break;
		}							//몇번째로 틀렸는지에 따라서 그림 출력
		if (count == 10)break;
	}
	if (count == 10) {
		hangmancase10();
		printf("You lose\n");
		lose = lose + 1;
	}
	else {
		printf("You Win\n");
		win = win + 1;
	}
	printf("answer is %s\n", solution);
	printf("메인 화면으로 돌아갑니다\n\n");
}
int main() {
	while (1) {
	printf("행맨게임에 오신것을 환영합니다\n");
	printf("이긴 게임 수 : %d\n", win);
	printf("진 게임수 : %d\n", lose);
	float percent = (win == 0) ? 0 : (float)win / (win + lose);
	printf("현재 승률 : %.2f%%\n", percent * 100);
		printf("1. 게임 플레이하기\n");
		printf("2. 게임 종료\n");
		int ifplay = 0;
		scanf("%d", &ifplay);
		while (ifplay < 1 || ifplay>2) {
			printf("잘못된 입력값입니다\n");
			printf("다시 입력해 주세요\n");
			scanf("%d", &ifplay);
		}
		if (ifplay == 1) {
			play();
		}
		else break;
	}

}